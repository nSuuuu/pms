<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>私信聊天</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h2>与 <span th:text="${toUser.username}"></span> 聊天</h2>
    <div class="border p-3 mb-3" style="height:300px;overflow-y:auto;">
        <div th:each="msg : ${messages}">
            <div th:if="${msg.fromUser.username == toUser.username}" class="text-start">
                <span class="badge bg-secondary">[[${msg.fromUser.username}]]</span>
                <span class="ms-2">[[${msg.content}]]</span>
                <span class="text-muted small ms-2">[[${#dates.format(msg.createTime, 'HH:mm')}]]</span>
            </div>
            <div th:if="${msg.fromUser.username != toUser.username}" class="text-end">
                <span class="text-muted small me-2">[[${#dates.format(msg.createTime, 'HH:mm')}]]</span>
                <span class="me-2">[[${msg.content}]]</span>
                <span class="badge bg-primary">我</span>
            </div>
        </div>
    </div>
    <form action="/chat/send" method="post" class="d-flex">
        <input type="hidden" name="toUserId" th:value="${toUser.id}" />
        <input type="text" name="content" class="form-control me-2" placeholder="输入消息..." required />
        <button type="submit" class="btn btn-success">发送</button>
    </form>
</div>
</body>
</html> 